# Netflix Wrapped

## Project Details
### Contributors
Frontend - klee161, khu21
Backend - khu21, dhan26, jcha17
ML modeling - jcha17
### Project Description
Currently, Netflix does not offer a “Netflix Wrapped” feature, and thus Netflix users seem to have no way of easily tracking and analyzing their viewing history and trends. Knowledge about this problem was gathered through various sources, including articles discussing the currently existing “Spotify Wrapped” feature and streaming services; user interviews with roommates, friends, and online forum users; and personal experience from group members with losing track of their Netflix activity.
Our "Netflix-Wrapped" project aims to solve this problem by **providing a personalized report of a user’s Netflix activity on our web application, where users can view their watch history and trends in media consumption.** After witnessing the highly anticipated annual event for music lovers with “Spotify Wrapped,” the sweeping popularity of the MBTI trend across the globe, and reading up on Twitter and Reddit posts talking about the need for a Netflix Wrapped feature (https://www.reddit.com/r/netflix/comments/rr8wq7/i_wanted_a_netflix_wrapped_really_badly_so_i_made/, https://twitter.com/mlgpp26/status/1645417563151646720?s=20, https://twitter.com/killingasher/status/1600222831727456256?s=20, https://twitter.com/sugar__bay/status/1608542903080726528?s=20, https://twitter.com/SyarifahAmin/status/1598635315505561600?s=20, to list a few), we chose to work on this problem to **provide Netflix users a unique and engaging way to understand themselves and connect with others through their streaming habits.**
### Repository
https://github.com/cs0320-s2023/netflix-wrapped
### Total Time
3 weeks

## Design Choices
**Our project is divided up into 2 main directories: `frontend` and `backend`.**

### `frontend`
The `frontend` directory contains the **UI** and **sending API requests** to the backend. Within `frontend`, we have subdirectories `public` and `src`.
- `public` contains the HTML file to be loaded upon starting the application in the browser
- `src` contains our assets, React components, frontend tests, mock data, and utilities for accessing our servers and Netflix Wrapped information by sending requests to the backend. 

_Here are the most important pieces of our `frontend` and how they function/connect:_
- `assets`is a package that contains various data structures and interfaces required to help organize and display the Netflix Wrapped report
  - `data` is a subpackage that contains `ReportJSON.tsx`, which is an interface that outlines the expected data structure of the Netflix Wrapped report generated by and received from the backend. This interface is used particularly in the `Landing` and `Report` components, in which the JSON is ensured to have the interface structure and is passed from the `Landing` to the `Report` components
  - `graphics` is a subpackage that contains `personality.tsx`, which holds the data structure that contains a graphic and descriptor for the NVTI personality a user is given by our backend ML model. 
  - `mock` is a subpackage that contains mock CSV and JSON files used for testing. 
- `components`is a package that contains the components of our Netflix Wrapped application
  - `landing` is a subpackage that contains the components of our Netflix Wrapped landing page
    - `Parsing` is a component that allows us to parse an uploaded CSV file into a JSON that can be sent to our backend
    - `Uploader` is a component which provides the input areas and interactions necessary for a user to upload their CSV and generate a report
  - `report` is a subpackage that contains the components of a generated Netflix Wrapped report page
    - `BingeData` is a component displaying the date and content a user binged the most on on Netflix
    - `MediaCarousel` is a component displaying a carousel of poster images
    - `NVTIPersonality` is a component displaying the personality assigned to a user based on their viewing behaviors by our backend ML
    - `ReportIntro` is a component displaying the introduction to the Netflix Wrapped report
    - `ReportWelcome` is a component displaying a welcome to the user, including their name if they input it on the Landing page
    - `Wipe` is a component that provides the information and interactions necessary for a user to wipe their data from our application and its servers
    - `WrappedEpisodes` is a component displaying a user's most watched shows and episodes
    - `WrappedFavActors` is a component displaying the most featured actors a user has wathced
    - `WrappedGenres` is a component displaying the user's most watched genres 
    - `WrappedMinutes` is a component displaying an estimation of the time a user has spent on Netflix
    - `WrappedMoviesOverview` is a component displaying a user's most watched movies
    - `WrappedOverview` is a component displaying all of the content a user has watched on Netflix
- `pages` is a package that contains the pages navigable through our application
  - `Error` is a page component displayed anytime anything goes wrong or doesn't load in our application
  - `ReportError` is a page component displayed when a user tries to access their report before generating it or after they've already wiped it from our application and its servers
  - `Landing` is the page component first loaded when our application is run
  - `Report` is the page component a user can access once they've uploaded their NetflixViewingHistory.csv and generated a report
- `test` is a package with our frontend tests (more on this package below)
  - `components` is a subpackage with tests of the components in the `components` package, such as rendering and interactions
  - `pages` is a subpackage with tests of the components in the `pages` package, such as rendering and interactions 
- `index.tsx` is the component where our router is hosted and our pathways to the different parts of the application are rendered and defined. 

### `backend`

## Tests
### Here is a summary of our backend tests
### Here is an overview of our frontend tests
- `test` is a package with our frontend tests (more on this package below)
  - `components` is a subpackage with tests of the components in the `components` package, such as rendering and interactions with populated and unpopulated mock data that would be sent by the backend
    - `report` is a subpackage with tests of the components used in the Report page
      - `BingeData.test` is a test ensuring that the `BingeData` component is rendering properly
        1. tests that the BingeData component with mock data from mockActor.json renders properly with expected images via alt text and aria-labels
        2. tests that the BingeData component with mock empty data from empty.json renders properly with the expected message that we weren't able to generate their binge data
      - `NVTIPersonality.test` is a test ensuring that the `NVTIPersonality` component is rendering properly
        1. tests that the NVTIPersonality component with mock data from mockActor.json renders properly with expected graphics and text via alt text and aria-labels
        2. tests that the NVTIPersonality component with mock empty data from empty.json renders properly with the expected message that we weren't able to generate their NVTI personality
      - `ReportIntro.test` is a test ensuring that the `ReportIntro` component is rendering properly
        1. tests that the ReportIntro component renders with the expected text
      - `ReportWelcome.test` is a test ensuring that the `ReportWelcome` component is rendering properly
        1. tests that the ReportWelcome component renders with the expected text with a name input
        2. tests that the ReportWelcome component renders with the expected text without a name input
      - `Wipe.test` is a test ensuring that the `Wipe` component is rendering properly
        1. tests that the Wipe component renders with the expected text and interaction elements via aria-labels
      - `WrappedEpisodes.test` is a test ensuring that the `WrappedEpisodes` component is rendering properly
        1. tests that the WrappedEpisodes component with mock data from mockActor.json renders properly with expected images and text via alt text and aria-labels
        2. tests that the WrappedEpisodes component with mock empty data from empty.json renders properly with the expected message that we weren't able to generate their show overview
      - `WrappedFavActors.test` is a test ensuring that the `WrappedFavActors` component is rendering properly
        1. tests that the WrappedFavActors component with mock data from mockActor.json renders properly with expected text and images via alt text and aria-labels
        2. tests that the WrappedFavActors component with mock empty data from empty.json renders properly with the expected message that we weren't able to generate their most watched actors 
      - `WrappedGenres.test` is a test ensuring that the `WrappedGenres` component is rendering properly
        1. tests that the WrappedGenres component with mock data from mockActor.json renders properly with expected images via alt text and aria-labels
        2. tests that the WrappedGenres component with mock empty data from empty.json renders properly with the expected message that we weren't able to generate their top genres 
      - `WrappedMinutes.test` is a test ensuring that the `WrappedMinutes` component is rendering properly
        1. tests that the WrappedMinutes component with mock data from mockActor.json and mock empty data from empty.json renders properly with expected text
      - `WrappedMoviesOverview.test` is a test ensuring that the `WrappedMoviesOverview` component is rendering properly
        1. tests that the WrappedMoviesOverview component with mock data from mockActor.json renders properly with expected images and text via alt text and aria-labels
        2. tests that the WrappedMoviesOverview component with mock empty data from empty.json renders properly with the expected message that we weren't able to generate their movie overview
      - `WrappedOverview.test` is a test ensuring that the `WrappedOverview` component is rendering properly
        1. tests that the WrappedOverview component with mock data from mockActor.json renders properly with expected images and text via alt text and aria-labels
          1. tests that the MediaCarousel component renders the images as expected
        3. tests that the WrappedOverview component with mock empty data from empty.json renders properly with the expected message that we weren't able to generate their overview
    - `landing` is a subpackage with tests of the components used in the Landing page
      - `Parsing.test` **KAREN TO DO**
      - `Uploader.test` is a test ensuring that the `Uploader` component is rendering properly
        1. tests that the Uploader component renders appropriately with the correct elements via aria-labels 
        2. tests that the interactions with the Uploader component elements causes the expected state changes
  - `pages` is a subpackage with tests of the components in the `pages` package, such as rendering and interactions with populated and unpopulated mock data that would be sent by the backend
    - `Landing.test` is a test that checks that the Landing component renders correctly, in addition to checking for the expected state changes upon certain interactions provided by the Uploader component
    - `ReportError.test`is a test that checks that the ReportError page render correctly with the expected text

## Bugs
### `frontend`
We had to utilize `POST` requests for uploading a user's NetflixViewingHistory.csv file when it was substantially large (when our request to the backend surpassed 2,048 characters), which caused some issues particularly with the CORS policy. As a result, we had to change the request mode to "no-cors" to be able to fetch the response with CORS disabled, which seemed to be the only way we were able to work around making the request successfully. However, this ended up limiting us from being able to return responses that were more specific on the nature of certain errors (like trying to pass a CSV with the incorrect headers or number of columns). As a result, this ended up limiting our ability to provide the appropriate feedback to the user based on the nature of the CSV file they uploaded. However, we did attempt to account for this in the backend endpoint handler that handles how a CSV is uploaded to our server. Next steps would be to look more into the nature of `POST` requests and their browser dependencies to understand how enable response specificity like we had been able to with `GET` requests. 

### `backend`
There are some inaccuracies with the poster images fetched for a user's given watched show or movie, as we were not able to access Netflix's API directly that would ideally be hosting images and information for all of the content hosted in their database. As a result, our dependency on The Movie Database API (https://www.themoviedb.org/) causes some inconsistencies between the images displayed and the show/movie in question.

## How to Run
### Build & Run Program
1. Clone our repository at [https://github.com/cs0320-s2023/netflix-wrapped].
2. Open the repository in two separate code environments.
    * within **VSCode**, enter the `frontend` directory using the command `cd frontend`. 
    * within another separate window of **VSCode** or in **IntelliJ**, enter the `backend` directory using the command `cd backend`.
3. In VSCode, run npm install. Once all of the necessary packages are installed, run `npm start` to load the Netflix Wrapped website in your default browser.
4.1. In IntelliJ, open the `backend` directory as a project using the `pom.xml` file. Then go to the `Server.java` class and first run `mvn package`. After that finishes successfully, start the server by clicking the green play button on line 16 or at the top of the window. 
4.2 In VSCode, install the 'Maven for Java' and 'Extension Pack for Java' extensions. Once the extensions are installed, Click Run Java for the file 'Server.java'.
5. Install Anaconda for Python following the steps in the website. Then, run 'conda create -n [environment name]' to create a virtual environment for machine learning.
6. Activate the virtual environment by the command conda activate [environment name]. Install the following packages: tensorflow (conda install tensorflow), numpy (pip install numpy), pandas (pip install pandas), flask (pip install flask), and flask-restful (pip install flask-restful).
7. Enter the `backend-ml` directory using the command `cd backend-ml`. Then run command 'flask --app server run' to run the NVTI classifier embedded in the python flask server.

### Run Tests
To run tests on the backend, enter the backend directory using `cd backend`. Then run `mvn test` in the terminal. To run
tests individually, go to the test class you'd like to run and click the play button on the left side of the code window.

To run tests on the frontend, enter the frontend directory using `cd frontend`. Then run `npm test` in the terminal. 

## Citations
Sending `POST` requests: https://stackoverflow.com/questions/66607373/how-to-send-a-post-request-on-typescript, https://bobbyhadz.com/blog/typescript-http-request#making-http-post-requests-in-typescript
React Routing: https://reactrouter.com/en/main
